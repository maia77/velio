#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฅููุชุฑูููุฉ ููููุน Velio Store
"""

import os
import sys
from datetime import datetime

# ุฅุถุงูุฉ ูุณุงุฑ ุงููุดุฑูุน
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

def test_email_system():
    """
    ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅูููู
    """
    print("๐งช ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฅููุชุฑูููุฉ")
    print("=" * 50)
    
    try:
        # ุงุณุชูุฑุงุฏ ุฏุงูุฉ ุฅุฑุณุงู ุงูุฅูููู
        from web.app import send_email
        
        # ุงุฎุชุจุงุฑ 1: ุฑุณุงูุฉ ุชูุงุตู
        print("๐ง ุงุฎุชุจุงุฑ 1: ุฑุณุงูุฉ ุชูุงุตู ุฌุฏูุฏุฉ")
        contact_subject = "๐ง ุฑุณุงูุฉ ุชูุงุตู ุฌุฏูุฏุฉ ูู ุฃุญูุฏ ูุญูุฏ"
        contact_body = """๐ ุฅุดุนุงุฑ ุฌุฏูุฏ ูู ูููุน Velio Store

๐ค ูุนูููุงุช ุงููุฑุณู:
ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: ahmed@example.com
ุงูุชุงุฑูุฎ: """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """

๐ ูุญุชูู ุงูุฑุณุงูุฉ:
ูุฑุญุจุงูุ ุฃุฑูุฏ ุงูุงุณุชูุณุงุฑ ุนู ููุชุฌ ูุนูู

๐ ููุฑุฏ ุนูู ุงูุนููู:
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: ahmed@example.com
- ุงูููุช: """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """

---
ูุฐู ุฑุณุงูุฉ ุชููุงุฆูุฉ ูู ูุธุงู ุฅุดุนุงุฑุงุช Velio Store"""
        
        result1 = send_email(contact_subject, contact_body)
        print(f"   ุงููุชูุฌุฉ: {'โ ูุฌุญ' if result1 else 'โ ูุดู'}")
        
        # ุงุฎุชุจุงุฑ 2: ุทูุจ ููุชุฌ
        print("\n๐ ุงุฎุชุจุงุฑ 2: ุทูุจ ููุชุฌ ุฌุฏูุฏ")
        order_subject = "๐ ุทูุจ ุฌุฏูุฏ #123 - ูุฑุณู ุญุฏูุซ"
        order_body = """๐ ุฅุดุนุงุฑ ุทูุจ ุฌุฏูุฏ ูู ูููุน Velio Store

๐ ุชูุงุตูู ุงูุทูุจ:
ุฑูู ุงูุทูุจ: #123
ุงูููุชุฌ: ูุฑุณู ุญุฏูุซ
ุงููููุฉ: 2
ุงูุณุนุฑ ุงููุงุญุฏ: 150.0 $
ุงูุณุนุฑ ุงูุฅุฌูุงูู: 300.0 $
ุงูุชุงุฑูุฎ: """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """

๐ค ูุนูููุงุช ุงูุนููู:
name: ุณุงุฑุฉ ุฃุญูุฏ
phone: +966501234567
email: sara@example.com
address: ุงูุฑูุงุถุ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ

๐ ููุชูุงุตู ูุน ุงูุนููู:
- ุฑูู ุงูุทูุจ: #123
- ุงูููุช: """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """

---
ูุฐู ุฑุณุงูุฉ ุชููุงุฆูุฉ ูู ูุธุงู ุฅุดุนุงุฑุงุช Velio Store"""
        
        result2 = send_email(order_subject, order_body)
        print(f"   ุงููุชูุฌุฉ: {'โ ูุฌุญ' if result2 else 'โ ูุดู'}")
        
        # ุงุฎุชุจุงุฑ 3: ุทูุจ ุดุงูู
        print("\n๐๏ธ ุงุฎุชุจุงุฑ 3: ุทูุจ ุดุงูู ูู ุณูุฉ ุงูุชุณูู")
        cart_subject = "๐ ุทูุจ ุดุงูู ุฌุฏูุฏ #124 - 3 ููุชุฌ"
        cart_body = """๐ ุฅุดุนุงุฑ ุทูุจ ุดุงูู ุฌุฏูุฏ ูู ูููุน Velio Store

๐ ููุฎุต ุงูุทูุจ:
ุฑูู ุงูุทูุจ: #124
ุนุฏุฏ ุงูููุชุฌุงุช: 3
ุงููุจูุบ ุงูุฅุฌูุงูู: 750.0 $
ุงููุจูุบ ุงููุทููุจ ุงูุขู (50%): 375.0 $
ุงููุจูุบ ุงููุชุจูู ุนูุฏ ุงูุชุณููู: 375.0 $
ุงูุชุงุฑูุฎ: """ + datetime.now().strftime('%Y-%m-%d %H:%M:%S') + """

๐๏ธ ุชูุงุตูู ุงูููุชุฌุงุช:

1. ูุฑุณู ุญุฏูุซ
   - ุงููููุฉ: 2
   - ุงูุณุนุฑ ุงูุฅุฌูุงูู: 300.0 $

2. ุทุงููุฉ ุฎุดุจูุฉ
   - ุงููููุฉ: 1
   - ุงูุณุนุฑ ุงูุฅุฌูุงูู: 450.0 $

๐ค ูุนูููุงุช ุงูุนููู:
ุงูุงุณู: ูุญูุฏ ุนูู
ุงููุงุชู: +966501234567
ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: mohammed@example.com
ุงูุนููุงู: ุฌุฏุฉุ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ
ุทุฑููุฉ ุงูุฏูุน: bank_transfer

๐ ููุชูุงุตู ูุน ุงูุนููู:
- ุฑูู ุงูุทูุจ: #124
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: mohammed@example.com
- ุงููุงุชู: +966501234567

---
ูุฐู ุฑุณุงูุฉ ุชููุงุฆูุฉ ูู ูุธุงู ุฅุดุนุงุฑุงุช Velio Store"""
        
        result3 = send_email(cart_subject, cart_body)
        print(f"   ุงููุชูุฌุฉ: {'โ ูุฌุญ' if result3 else 'โ ูุดู'}")
        
        # ููุฎุต ุงููุชุงุฆุฌ
        print("\n๐ ููุฎุต ุงููุชุงุฆุฌ:")
        print(f"   ุฑุณุงุฆู ุงูุชูุงุตู: {'โ' if result1 else 'โ'}")
        print(f"   ุทูุจุงุช ุงูููุชุฌุงุช: {'โ' if result2 else 'โ'}")
        print(f"   ุทูุจุงุช ุดุงููุฉ: {'โ' if result3 else 'โ'}")
        
        if all([result1, result2, result3]):
            print("\n๐ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ูุฌุญุช! ูุธุงู ุงูุฅุดุนุงุฑุงุช ูุนูู ุจุดูู ุตุญูุญ.")
            print("๐ง ุชุญูู ูู ุตูุฏูู ุงููุงุฑุฏ ูู velio.contact@yahoo.com")
        else:
            print("\nโ๏ธ ุจุนุถ ุงูุงุฎุชุจุงุฑุงุช ูุดูุช. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู.")
            
    except ImportError as e:
        print(f"โ ุฎุทุฃ ูู ุงูุงุณุชูุฑุงุฏ: {e}")
        print("ุชุฃูุฏ ูู ุชุดุบูู ุงูุณูุฑูุจุช ูู ูุฌูุฏ ุงููุดุฑูุน ุงูุฑุฆูุณู")
    except Exception as e:
        print(f"โ ุฎุทุฃ ุบูุฑ ูุชููุน: {e}")

def check_email_config():
    """
    ูุญุต ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
    """
    print("๐ ูุญุต ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู")
    print("=" * 40)
    
    sender_email = os.environ.get('SENDER_EMAIL')
    sender_password = os.environ.get('SENDER_PASSWORD')
    receiver_email = 'velio.contact@yahoo.com'
    
    print(f"๐ง ุงูุฅูููู ุงููุฑุณู: {sender_email if sender_email else 'ุบูุฑ ูุญุฏุฏ'}")
    print(f"๐ ูููุฉ ุงููุฑูุฑ: {'ูุญุฏุฏุฉ' if sender_password else 'ุบูุฑ ูุญุฏุฏุฉ'}")
    print(f"๐ฌ ุงูุฅูููู ุงููุณุชูุจู: {receiver_email}")
    
    if sender_email and sender_password:
        print("โ ุงูุฅุนุฏุงุฏุงุช ููุชููุฉ")
        return True
    else:
        print("โ ุงูุฅุนุฏุงุฏุงุช ุบูุฑ ููุชููุฉ")
        print("\nูุฅููุงู ุงูุฅุนุฏุงุฏ:")
        print("1. ุฃูุดุฆ ููู .env ูู ูุฌูุฏ ุงููุดุฑูุน")
        print("2. ุฃุถู:")
        print("   SENDER_EMAIL=your-email@gmail.com")
        print("   SENDER_PASSWORD=your-app-password")
        return False

if __name__ == "__main__":
    print("๐ ุจุฏุก ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฅููุชุฑูููุฉ")
    print()
    
    # ูุญุต ุงูุฅุนุฏุงุฏุงุช
    if check_email_config():
        print()
        # ุงุฎุชุจุงุฑ ุงููุธุงู
        test_email_system()
    else:
        print("\nโ๏ธ ูุฑุฌู ุฅููุงู ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃููุงู")
    
    print("\n๐ ููุงุญุธุงุช:")
    print("- ุฌููุน ุงูุฅุดุนุงุฑุงุช ุชูุฑุณู ุฅูู: velio.contact@yahoo.com")
    print("- ุชุฃูุฏ ูู ูุญุต ูุฌูุฏ Spam/Junk")
    print("- ุงุณุชุฎุฏู ูููุฉ ูุฑูุฑ ุงูุชุทุจููุงุช ูููุณ ูููุฉ ูุฑูุฑ ุงูุญุณุงุจ")
