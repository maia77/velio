#!/bin/bash

# ููู ุชุดุบูู ูุจุณุท ููุชุทุจูููู

echo "๐ ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ"
echo "============================================================"

# ุงูุชุญูู ูู ูุฌูุฏ Python
if ! command -v python3 &> /dev/null; then
    echo "โ Python3 ุบูุฑ ูุซุจุช. ูุฑุฌู ุชุซุจูุช Python3 ุฃููุงู"
    exit 1
fi

echo "โ ุชู ุงูุชุญูู ูู Python3"

# ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช
echo "๐ง ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
python3 simple_setup.py

# ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
echo "๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช..."
python3 shared_database_config_fallback.py

echo ""
echo "๐ ูุนูููุงุช ุงูุชุดุบูู:"
echo "   ๐ ุชุทุจูู ุงูููุจ: http://127.0.0.1:5003"
echo "   ๐ง ุชุทุจูู ุงูุฅุฏุงุฑุฉ: http://127.0.0.1:5007"
echo "   ๐พ ูุงุนุฏุฉ ุงูุจูุงูุงุช: ูุดุชุฑูุฉ ุจูู ุงูุชุทุจูููู (SQLite ูุญููุฉ)"
echo ""

# ุชุดุบูู ุงูุชุทุจูููู ูู ุฎูููุฉ ูููุตูุฉ
echo "๐ ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู..."

# ุชุดุบูู ุชุทุจูู ุงูููุจ ูู ุงูุฎูููุฉ
cd web
python3 app.py &
WEB_PID=$!

# ุงูุนูุฏุฉ ูููุฌูุฏ ุงูุฑุฆูุณู
cd ..

# ุชุดุบูู ุชุทุจูู ุงูุฅุฏุงุฑุฉ ูู ุงูุฎูููุฉ
cd admin-app
python3 admin_app_fixed.py &
ADMIN_PID=$!

# ุงูุนูุฏุฉ ูููุฌูุฏ ุงูุฑุฆูุณู
cd ..

echo "โ ุชู ุจุฏุก ุชุดุบูู ุงูุชุทุจูููู ุจูุฌุงุญ!"
echo "๐ ุงุถุบุท Ctrl+C ูุฅููุงู ุงูุชุทุจูููู"

# ุงูุชุธุงุฑ ุฅุดุงุฑุฉ ุงูุฅููุงู
trap "echo '๐ ุฅููุงู ุงูุชุทุจูููู...'; kill $WEB_PID $ADMIN_PID; exit" INT

# ุงูุชุธุงุฑ ุงูุชูุงุก ุงูุนูููุงุช
wait

