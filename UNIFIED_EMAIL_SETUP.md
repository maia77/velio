# 🔧 إعداد موحد للبريد الإلكتروني - Velio Store

## 🎯 المشكلة
❌ **الرسائل لا تُرسل من نموذج "اتصل بنا" والطلبات**

## 🔍 السبب
إعدادات البريد الإلكتروني في ملف `.env` تحتوي على قيم افتراضية:
```
SENDER_EMAIL=your-email@yahoo.com
SENDER_PASSWORD=your-app-password
```

## ⚡ الحل السريع (إعداد موحد)

### الطريقة 1: السكريبت التلقائي (الأسهل)
```bash
python3 fix_contact_form_unified.py
```

### الطريقة 2: الإعداد اليدوي

#### 1. افتح ملف `.env` في محرر النصوص
```bash
nano .env
```

#### 2. استبدل القيم الافتراضية بالبيانات الحقيقية:
```env
EMAIL_PROVIDER=yahoo
SENDER_EMAIL=your-real-email@yahoo.com
SENDER_PASSWORD=your-real-app-password
RECEIVER_EMAIL=your-real-email@yahoo.com
```

#### 3. احفظ الملف وأعد تشغيل التطبيق

## 🎯 النظام الموحد

### ✅ نفس البريد الإلكتروني لجميع الخدمات:
- 📧 **رسائل نموذج "اتصل بنا"**
- 🛒 **إشعارات الطلبات الجديدة**
- 📍 **إشعارات المواقع**
- 🔔 **جميع الإشعارات الأخرى**

### 📬 تدفق الرسائل:
- **إشعارات الطلبات** → بريد المدير (نفس المرسل)
- **رسائل "اتصل بنا"** → بريد المدير (نفس المرسل)
- **رسائل تأكيد العملاء** → بريد العميل

## 🔑 الحصول على كلمة مرور التطبيقات

### لـ Yahoo Mail:
1. اذهب إلى: https://login.yahoo.com/
2. اختر **Account Info** > **Account Security**
3. فعّل **Two-step verification** إذا لم يكن مفعلاً
4. ابحث عن **App passwords** أو **Generate app password**
5. اختر **Mail** وادخل اسم للتطبيق مثل **Velio Store**
6. انسخ كلمة المرور التي تظهر

### لـ Gmail:
1. اذهب إلى: https://myaccount.google.com/
2. اختر **Security** > **App passwords**
3. اختر **Mail** وادخل اسم للتطبيق
4. انسخ كلمة المرور

### لـ Outlook:
1. اذهب إلى: https://account.microsoft.com/
2. اختر **Security** > **App passwords**
3. اختر **Mail** وادخل اسم للتطبيق
4. انسخ كلمة المرور

## 🧪 اختبار النظام

### 1. اختبار شامل:
```bash
python3 test_unified_email.py
```

### 2. اختبار سريع:
```bash
python3 quick_email_test.py
```

### 3. اختبار النموذج:
1. اذهب إلى صفحة "اتصل بنا"
2. املأ النموذج
3. أرسل الرسالة
4. تحقق من صندوق الوارد

### 4. اختبار الطلبات:
1. أضف منتج للسلة
2. أكمل الطلب
3. تحقق من وصول إشعار الطلب

## 🔧 استكشاف الأخطاء

### مشكلة: "إعدادات البريد الإلكتروني غير مكتملة"
**الحل**: تأكد من وجود ملف `.env` مع القيم الصحيحة

### مشكلة: "فشل في إرسال إشعار البريد الإلكتروني"
**الحل**: 
1. تحقق من كلمة مرور التطبيقات
2. تأكد من تفعيل Two-step verification
3. تحقق من صحة الإيميل

### مشكلة: الرسائل لا تصل
**الحل**:
1. تحقق من مجلد Spam/Junk
2. تأكد من صحة الإيميل المستقبل
3. جرب إرسال رسالة اختبار

### مشكلة: الطلبات تعمل لكن "اتصل بنا" لا يعمل
**الحل**: 
1. تأكد من تشغيل التطبيق
2. تحقق من API endpoint
3. راجع سجلات التطبيق

## 📧 أنواع الإشعارات

عند الإعداد الصحيح، ستصلك رسائل عند:
- 📧 إرسال رسالة تواصل جديدة
- 🛒 طلب منتج واحد
- 🛍️ طلب شامل من سلة التسوق
- 📍 استلام موقع GPS
- 🔔 أي نشاط آخر في النظام

## 🎯 النتيجة المتوقعة

بعد الإعداد الصحيح:
- ✅ جميع الإشعارات تصل إلى البريد المحدد
- ✅ رسائل منسقة مع رموز تعبيرية
- ✅ معلومات مفصلة عن العميل والطلب
- ✅ نظام أمان محمي
- ✅ إعداد موحد لجميع الخدمات

## 🔄 دعم متعدد المزودين

النظام يدعم:
- 🔵 **Yahoo Mail** (افتراضي)
- 🔴 **Gmail**
- 🟠 **Outlook/Hotmail**

يتم تحديد المزود تلقائياً من عنوان الإيميل.

## 📞 الدعم

إذا استمرت المشكلة:
1. تحقق من سجلات التطبيق
2. جرب إعادة تشغيل التطبيق
3. تأكد من صحة جميع الإعدادات
4. راجع ملف `CONTACT_FORM_FIX_GUIDE.md` للمزيد من التفاصيل

## 🚀 الخطوات السريعة

1. **إعداد البريد:**
   ```bash
   python3 fix_contact_form_unified.py
   ```

2. **اختبار النظام:**
   ```bash
   python3 test_unified_email.py
   ```

3. **تشغيل التطبيق:**
   ```bash
   python3 web/app.py
   ```

4. **اختبار في المتصفح**

---

**ملاحظة**: تأكد من استخدام كلمة مرور التطبيقات وليس كلمة مرور الحساب العادية!
